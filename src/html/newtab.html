<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../../assets/icons/icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <title>iNewTab</title>
</head>
<body>
    <!-- Settings Button with Hover Trigger Area -->
    <div class="settings-hover-area">
        <div class="settings-container-top">
            <button class="settings-trigger-top" id="settingsBtn" title="Settings">
                <i class="material-icons">settings</i>
            </button>
        </div>
    </div>

    <div class="main-content">
        <div class="greeting" id="greeting">Good Morning</div>
        <div class="quote-container" id="quoteContainer">
            <div class="quote-text" id="quoteText">Loading...</div>
            <div class="quote-author" id="quoteAuthor"></div>
        </div>

        <form id="searchForm" style="width: 100%; max-width: 600px;">
            <input
                type="text"
                name="q"
                class="search-box"
                id="searchBox"
                placeholder="Search..."
                autocomplete="off"
                autofocus
            >
        </form>

        <div class="tasks-container" id="tasksContainer">
            <div class="tasks-header">
                <div class="tasks-title">Tasks</div>
                <div class="sync-status-minimal" id="syncStatusMinimal">Not synced</div>
            </div>
            <input type="text" class="task-input" id="taskInput" placeholder="New task...">
            <ul class="task-list" id="taskList"></ul>
            
            <div class="completed-tasks-section" id="completedTasksSection" style="display: none;">
                <div class="completed-tasks-header" id="completedTasksHeader">
                    <span class="completed-tasks-title">Completed Tasks</span>
                    <span class="completed-tasks-count" id="completedTasksCount">(0)</span>
                    <button class="completed-tasks-toggle" id="completedTasksToggle">
                        <i class="material-icons">expand_more</i>
                    </button>
                </div>
                <ul class="completed-task-list" id="completedTaskList" style="display: none;"></ul>
            </div>
        </div>
    </div>

    <div class="bottom-widgets">
        <div class="weather-widget" id="weather">
            <div class="weather-location">Loading...</div>
        </div>

        <div class="clock-date-widget" id="clockDateWidget">
            <div class="clock" id="clock">00:00:00</div>
            <div class="date" id="date"></div>
        </div>
    </div>

    <div class="news-ticker" id="newsTicker">
        <div class="ticker-content" id="ticker">
            <span class="ticker-item">Loading news...</span>
        </div>
    </div>

    <!-- Search Help Modal -->
    <div class="help-modal-overlay" id="helpModalOverlay">
        <div class="help-modal" id="helpModal">
            <div class="help-header">
                <h3>Search Engine Shortcuts</h3>
                <button class="help-close" id="helpClose">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div class="help-content">
                <p class="help-description">Type a shortcut and press <kbd>Tab</kbd> to select a search engine</p>

                <div class="shortcuts-grid" id="shortcutsGrid">
                    <!-- Shortcuts will be dynamically populated -->
                </div>

                <div class="help-tips">
                    <h4>Tips</h4>
                    <ul>
                        <li>Press <kbd>Tab</kbd> after typing a shortcut to activate the search engine</li>
                        <li>Press <kbd>Esc</kbd> to clear the selected engine</li>
                        <li>Press <kbd>Ctrl</kbd>+<kbd>/</kbd> to show/hide this help</li>
                        <li>Click the <kbd>×</kbd> on a tag to remove the selection</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Popup -->
    <div class="settings-popup" id="settingsPopup">
        <div class="settings-header">
            <h3>Settings</h3>
            <button class="settings-close" id="settingsClose">
                <i class="material-icons">close</i>
            </button>
        </div>

        <div class="settings-tabs">
            <button class="tab-btn active" data-tab="general">
                <i class="material-icons">settings</i>
                General
            </button>
            <button class="tab-btn" data-tab="google">
                <i class="material-icons">cloud</i>
                Google
            </button>
            <button class="tab-btn" data-tab="news">
                <i class="material-icons">rss_feed</i>
                News
            </button>
        </div>

        <div class="settings-content">
            <!-- General Tab -->
            <div class="tab-content active" id="generalTab">
                <div class="settings-section">
                    <h4 class="section-heading">Theme</h4>
                    <div class="settings-row">
                        <div class="theme-toggle">
                            <button class="theme-btn active" data-theme="dark">
                                <i class="material-icons">dark_mode</i>
                                Dark
                            </button>
                            <button class="theme-btn" data-theme="light">
                                <i class="material-icons">light_mode</i>
                                Light
                            </button>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h4 class="section-heading">Visibility</h4>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showGreeting" checked>
                            <span>Show Greeting</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showQuote" checked>
                            <span>Show Quote</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showClockDate" checked>
                            <span>Show Clock & Date</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showSearch" checked>
                            <span>Show Search</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showTasks" checked>
                            <span>Show Tasks</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showWeather" checked>
                            <span>Show Weather</span>
                        </label>
                    </div>
                    <div class="settings-row visibility-row">
                        <label class="visibility-label">
                            <input type="checkbox" id="showNews" checked>
                            <span>Show News Ticker</span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h4 class="section-heading">Storage</h4>
                    <div class="settings-row">
                        <div class="storage-info">
                            <div class="storage-bar">
                                <div class="storage-used" id="storageBar"></div>
                            </div>
                            <div class="storage-text" id="storageText">Loading...</div>
                        </div>
                    </div>

                    <div class="settings-row">
                        <button id="clearStorageBtn" class="settings-btn danger">
                            <i class="material-icons">delete</i>
                            Clear All Data
                        </button>
                    </div>
                </div>
            </div>

            <!-- Google Tab -->
            <div class="tab-content" id="googleTab">
                <div class="settings-section">
                    <h4 class="section-heading">Google Tasks Sync</h4>
                    <div class="settings-row">
                        <button id="settingsGoogleAuth" class="settings-btn">
                            <i class="material-icons">account_circle</i>
                            <span id="authButtonText">Connect</span>
                        </button>
                    </div>

                    <div class="settings-row" id="taskListSelectionRow" style="display: none;">
                        <label for="taskListSelect" class="settings-label">Task List:</label>
                        <select id="taskListSelect" class="settings-select">
                            <option value="">Select a task list...</option>
                        </select>
                    </div>

                    <div class="settings-row">
                        <button id="settingsResync" class="settings-btn" disabled>
                            <i class="material-icons">sync</i>
                            Sync Now
                        </button>
                    </div>

                    <div class="settings-row">
                        <div class="sync-status-text" id="settingsSyncStatus">Not connected</div>
                    </div>
                </div>
            </div>

            <!-- News Tab -->
            <div class="tab-content" id="newsTab">
                <div class="settings-section">
                    <h4 class="section-heading">RSS Feeds</h4>
                    <div class="settings-row">
                        <div class="rss-list" id="rssList">
                            <!-- RSS feeds will be populated here -->
                        </div>
                    </div>

                    <div class="settings-row">
                        <input type="url" id="newRssUrl" placeholder="Add RSS feed URL" class="rss-input">
                    </div>

                    <div class="settings-row">
                        <button id="addRssBtn" class="settings-btn">
                            <i class="material-icons">add</i>
                            Add RSS Feed
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Credits -->
        <div class="settings-footer">
            <div class="credits">
                <strong>iNewTab</strong> by <strong>Naveed Ahmed</strong> • <strong>INATIQO Pty Ltd</strong> • <span class="version">v2.2.0</span>
            </div>
        </div>
    </div>

    <!-- Utility scripts -->
    <script src="../js/utils/constants.js"></script>
    <script src="../js/utils/helpers.js"></script>

    <!-- Core modules -->
    <script src="../js/modules/chrome-storage.js"></script>
    <script src="../js/modules/google-tasks.js"></script>
    <script src="../js/modules/sync-manager.js"></script>
    <script src="../js/modules/task-renderer.js"></script>
    <script src="../js/modules/weather-module.js"></script>
    <script src="../js/modules/news-module.js"></script>
    <script src="../js/modules/greeting-module.js"></script>
    <script src="../js/modules/settings-module.js"></script>
    <script src="../js/modules/search-module.js"></script>

    <!-- Main application -->
    <script src="../js/main.js"></script>
</body>
</html>